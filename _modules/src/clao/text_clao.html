

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>src.clao.text_clao &mdash; clpt &#39;0.0.1&#39; documentation</title>
  

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/graphviz.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
    <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home" alt="Documentation Home"> clpt
          

          
          </a>

          
            
            
              <div class="version">
                '0.0.1'
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p><span class="caption-text">Docs:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../src.html">src</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">clpt</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="../../index.html">Module code</a> &raquo;</li>
        
      <li>src.clao.text_clao</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for src.clao.text_clao</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Create a TextCALO.</span>

<span class="sd">Initial version of the text annotation objects, in line with XML schema illustrated in 2022 NaaCL paper.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">Any</span><span class="p">,</span> <span class="n">Callable</span><span class="p">,</span> <span class="n">Dict</span><span class="p">,</span> <span class="n">List</span><span class="p">,</span> <span class="n">Optional</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">,</span> <span class="n">Type</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">lxml</span> <span class="kn">import</span> <span class="n">etree</span>
<span class="kn">from</span> <span class="nn">omegaconf</span> <span class="kn">import</span> <span class="n">DictConfig</span>

<span class="kn">from</span> <span class="nn">src.clao.clao</span> <span class="kn">import</span> <span class="n">CLAOElement</span><span class="p">,</span> <span class="n">CLAOElementContainer</span><span class="p">,</span> <span class="n">ClinicalLanguageAnnotationObject</span><span class="p">,</span> <span class="n">IdCLAOElement</span>
<span class="kn">from</span> <span class="nn">src.constants.annotation_constants</span> <span class="kn">import</span> <span class="n">ANNOTATION</span><span class="p">,</span> <span class="n">CLEANED_TEXT</span><span class="p">,</span> <span class="n">DESCRIPTION</span><span class="p">,</span> <span class="n">EMBEDDING</span><span class="p">,</span> <span class="n">EMBEDDING_ID</span><span class="p">,</span> \
    <span class="n">ENTITIES</span><span class="p">,</span> <span class="n">ENTITY</span><span class="p">,</span> <span class="n">ENTITY_GROUP</span><span class="p">,</span> <span class="n">EntityType</span><span class="p">,</span> <span class="n">HEADING</span><span class="p">,</span> <span class="n">LITERAL</span><span class="p">,</span> <span class="n">PARAGRAPH</span><span class="p">,</span> <span class="n">PARAGRAPHS</span><span class="p">,</span> <span class="n">RAW_TEXT</span><span class="p">,</span> <span class="n">SECTION</span><span class="p">,</span> <span class="n">SENTENCE</span><span class="p">,</span> \
    <span class="n">SENTENCES</span><span class="p">,</span> <span class="n">SPAN</span><span class="p">,</span> <span class="n">TEXT</span><span class="p">,</span> <span class="n">TEXT_ELEMENT</span><span class="p">,</span> <span class="n">TOKEN</span><span class="p">,</span> <span class="n">TOKENS</span><span class="p">,</span> <span class="n">VECTOR</span><span class="p">,</span> <span class="n">ACTUAL_LABEL</span><span class="p">,</span> <span class="n">PREDICTION</span><span class="p">,</span> <span class="n">PROBABILITY</span>


<div class="viewcode-block" id="TextCLAOElement"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAOElement">[docs]</a><span class="k">class</span> <span class="nc">TextCLAOElement</span><span class="p">(</span><span class="n">CLAOElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Basic element of a Text CLAO object.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Generic CLAOElement specifically for use with TextCLAOs&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TextCLAOElement</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="TextCLAOElement.from_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAOElement.from_json">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_json</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">json_dict</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">ClinicalLanguageAnnotationObject</span><span class="p">):</span>
        <span class="k">pass</span></div>

<div class="viewcode-block" id="TextCLAOElement.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAOElement.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">ClinicalLanguageAnnotationObject</span><span class="p">):</span>
        <span class="k">pass</span></div></div>


<div class="viewcode-block" id="Span"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Span">[docs]</a><span class="k">class</span> <span class="nc">Span</span><span class="p">(</span><span class="n">TextCLAOElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;TextCLAOElement representing a span of text.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        element_name: Name of element as it should appear in an XML tag, default is span</span>
<span class="sd">        start_offset(int): start offset for a Span</span>
<span class="sd">        end_offset(int): ending offset for a Span</span>
<span class="sd">        span_map: arbitrary dict of extra properties for this element. Default is None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">SPAN</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Span.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Span</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">=</span> <span class="n">start_offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span> <span class="o">=</span> <span class="n">end_offset</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="n">span_map</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">span_map</span>

<div class="viewcode-block" id="Span.adjust_offsets"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Span.adjust_offsets">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Adjust the start and end offsets of this Span by the provided delta.</span>

<span class="sd">        Args:</span>
<span class="sd">            delta (int): How much to shift the offsets. To reduce the offsets, this should be negative.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">+=</span> <span class="n">delta</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span> <span class="o">+=</span> <span class="n">delta</span></div>

<div class="viewcode-block" id="Span.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Span.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Span start and end attributes.&quot;&quot;&quot;</span>
        <span class="n">span_map</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Span</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span>
                <span class="s1">&#39;start&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">),</span>
                <span class="s1">&#39;end&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span><span class="p">),</span>
                <span class="o">**</span><span class="n">span_map</span><span class="p">}</span></div>

<div class="viewcode-block" id="Span.get_text_from"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Span.get_text_from">[docs]</a>    <span class="k">def</span> <span class="nf">get_text_from</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">text_clao</span><span class="p">:</span> <span class="s1">&#39;TextCLAO&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the text for this Span from the TextCLAO that contains it.</span>

<span class="sd">        Args:</span>
<span class="sd">            text_clao: The TextCLAO object that contains this Span</span>

<span class="sd">        Returns:</span>
<span class="sd">            The text encompassed by this Span</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">text_clao</span><span class="o">.</span><span class="n">get_text_for_span</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

<div class="viewcode-block" id="Span.overlaps"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Span.overlaps">[docs]</a>    <span class="k">def</span> <span class="nf">overlaps</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine if this Span overlaps another.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: a Span</span>
<span class="sd">        Returns:</span>
<span class="sd">            Whether or not these two spans overlap at all</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;</span> <span class="n">other</span><span class="o">.</span><span class="n">end_offset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span> <span class="o">&gt;</span> <span class="n">other</span><span class="o">.</span><span class="n">start_offset</span></div>

<div class="viewcode-block" id="Span.contains"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Span.contains">[docs]</a>    <span class="k">def</span> <span class="nf">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Determine whether this Span contains another.</span>

<span class="sd">        Args:</span>
<span class="sd">            other: a Span</span>
<span class="sd">        Returns:</span>
<span class="sd">            Whether or not `other` is wholly contained within this Span</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">&lt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">start_offset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span> <span class="o">&gt;=</span> <span class="n">other</span><span class="o">.</span><span class="n">end_offset</span></div>

<div class="viewcode-block" id="Span.get_span_embedding"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Span.get_span_embedding">[docs]</a>    <span class="k">def</span> <span class="nf">get_span_embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">List</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">],</span> <span class="n">Any</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">,</span> <span class="o">**</span><span class="n">method_args</span>
                           <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get embedding vector for a span.</span>

<span class="sd">        Span must either be a EmbeddingContainer or TokenContainer. If span is a TokenContainer, embedding will be</span>
<span class="sd">        calculated using `method` argument on all sub-embeddings. `method` must take a list of numpy.ndarrays as its</span>
<span class="sd">        first argument and return a single numpy.ndarray.</span>

<span class="sd">        Args:</span>
<span class="sd">            method: method used to calculate Span embedding from sub embeddings. Defaults to numpy.mean()</span>
<span class="sd">            **method_args: extra arguments to be passed in to `method`</span>

<span class="sd">        Returns:</span>
<span class="sd">            embedding vector in np.ndarray format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">method_args</span><span class="p">:</span>
            <span class="n">method_args</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;axis&#39;</span><span class="p">:</span> <span class="mi">0</span><span class="p">}</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">EmbeddingContainer</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">vector</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">TokenContainer</span><span class="p">):</span>
            <span class="n">embedding_vectors</span> <span class="o">=</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">embedding</span><span class="o">.</span><span class="n">vector</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">method</span><span class="p">(</span><span class="n">embedding_vectors</span><span class="p">,</span> <span class="o">**</span><span class="n">method_args</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s1">&#39;Embedding vector cannot be calculated for Spans that are not Tokens or do not &#39;</span>
                                      <span class="s1">&#39;contain Tokens with pre-calculated embeddings&#39;</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__len__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the length of the Span.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compare the instances of the class.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">start_offset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">end_offset</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">map</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">map</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Return the Span class object as a string.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Span(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Compute the string representation of a Span object.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>


<div class="viewcode-block" id="TextCLAO"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO">[docs]</a><span class="k">class</span> <span class="nc">TextCLAO</span><span class="p">(</span><span class="n">Span</span><span class="p">,</span> <span class="n">ClinicalLanguageAnnotationObject</span><span class="p">[</span><span class="nb">str</span><span class="p">]):</span>
    <span class="sd">&quot;&quot;&quot;The CLAO object for handling textual data.</span>

<span class="sd">    Class Attributes:</span>
<span class="sd">        element_name: Name of element as it should appear in an XML tag; default is annotation</span>
<span class="sd">        _top_level_elements: List of elements to be serialized in the top level of the annotation schema. All other CLAO</span>
<span class="sd">        elements to be serialized should be contained within one of these</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">ANNOTATION</span>
    <span class="n">_top_level_elements</span> <span class="o">=</span> <span class="p">[</span><span class="n">TEXT_ELEMENT</span><span class="p">,</span> <span class="n">SENTENCE</span><span class="p">,</span> <span class="n">EMBEDDING</span><span class="p">,</span> <span class="n">ENTITY_GROUP</span><span class="p">,</span> <span class="n">ACTUAL_LABEL</span><span class="p">,</span> <span class="n">PREDICTION</span><span class="p">,</span> <span class="n">PROBABILITY</span><span class="p">]</span>
    <span class="n">_text_clao_element_dict</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">raw_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">cfg</span><span class="p">:</span> <span class="n">DictConfig</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a TextCLAO.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TextCLAO</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">start_offset</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">end_offset</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">raw_text</span><span class="p">),</span> <span class="n">raw_data</span><span class="o">=</span><span class="n">Text</span><span class="p">(</span><span class="n">raw_text</span><span class="p">,</span> <span class="n">RAW_TEXT</span><span class="p">),</span>
                                       <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span> <span class="n">cfg</span><span class="o">=</span><span class="n">cfg</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="TextCLAO.from_file"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.from_file">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">input_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a new TextCLAO from a data file&quot;&quot;&quot;</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">TextCLAO</span><span class="o">.</span><span class="n">get_base_name_from_path</span><span class="p">(</span><span class="n">input_path</span><span class="p">)</span>
        <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">input_path</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">(),</span> <span class="n">name</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextCLAO.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Span start and end attributes.&quot;&quot;&quot;</span>
        <span class="n">json_dict</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TextCLAO</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">element_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_level_elements</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
                <span class="n">json_dict</span><span class="p">[</span><span class="n">element_type</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">element_type</span><span class="p">]]</span>
        <span class="k">return</span> <span class="n">json_dict</span></div>

<div class="viewcode-block" id="TextCLAO.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with annotation attributes to XML.&quot;&quot;&quot;</span>
        <span class="n">annotation</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">TextCLAO</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">attribs</span><span class="o">=</span><span class="p">{})</span>
        <span class="k">for</span> <span class="n">element_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_top_level_elements</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">element_type</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">elements</span><span class="p">[</span><span class="n">element_type</span><span class="p">]:</span>
                    <span class="n">element</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">annotation</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">annotation</span></div>

<div class="viewcode-block" id="TextCLAO.from_xml_file"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.from_xml_file">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml_file</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">file_path</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Load a CLAO element from an XML file&quot;&quot;&quot;</span>
        <span class="n">xml</span> <span class="o">=</span> <span class="n">etree</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
        <span class="n">annotation</span> <span class="o">=</span> <span class="n">xml</span><span class="o">.</span><span class="n">getroot</span><span class="p">()</span>
        <span class="n">xml_elements</span> <span class="o">=</span> <span class="n">annotation</span><span class="o">.</span><span class="n">getchildren</span><span class="p">()</span>
        <span class="n">raw_text</span> <span class="o">=</span> <span class="n">xml_elements</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">clao</span> <span class="o">=</span> <span class="bp">cls</span><span class="p">(</span><span class="n">raw_text</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="bp">cls</span><span class="o">.</span><span class="n">get_base_name_from_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">xml_element</span> <span class="ow">in</span> <span class="n">xml_elements</span><span class="p">:</span>
            <span class="n">element_cls</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">text_clao_element_dict</span><span class="p">()[</span><span class="n">xml_element</span><span class="o">.</span><span class="n">tag</span><span class="p">]</span>
            <span class="n">clao_element</span> <span class="o">=</span> <span class="n">element_cls</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">xml_element</span><span class="p">,</span> <span class="n">clao</span><span class="p">)</span>
            <span class="n">clao</span><span class="o">.</span><span class="n">insert_annotation</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">tag</span><span class="p">,</span> <span class="n">clao_element</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">clao</span></div>

<div class="viewcode-block" id="TextCLAO.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">ClinicalLanguageAnnotationObject</span><span class="p">):</span>
        <span class="k">raise</span> <span class="ne">NotImplementedError</span><span class="p">(</span><span class="s2">&quot;Method not implemented for class TextCLAO. Use from_xml_file() instead&quot;</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextCLAO.get_text_for_offsets"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.get_text_for_offsets">[docs]</a>    <span class="k">def</span> <span class="nf">get_text_for_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the text between two offsets.</span>

<span class="sd">        Offsets should not be adjusted to account for the document&#39;s start_offset, as that is handled within this</span>
<span class="sd">        method.</span>

<span class="sd">        Args:</span>
<span class="sd">            start (int): Starting (absolute) offset</span>
<span class="sd">            end (int): Ending (absolute) offset</span>

<span class="sd">        Returns:</span>
<span class="sd">            the text between the two specified offsets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">text</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">CLEANED_TEXT</span><span class="p">})</span>
                <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;description&#39;</span><span class="p">:</span> <span class="n">RAW_TEXT</span><span class="p">}))</span><span class="o">.</span><span class="n">raw_text</span>
        <span class="k">return</span> <span class="n">text</span><span class="p">[</span><span class="n">start</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">:</span><span class="n">end</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="p">]</span></div>

<div class="viewcode-block" id="TextCLAO.get_text_for_span"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.get_text_for_span">[docs]</a>    <span class="k">def</span> <span class="nf">get_text_for_span</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Get the text for a given Span contained within this document.</span>

<span class="sd">           clao.get_text_for_span(span) and span.get_text_from(clao) are equivalent calls.</span>

<span class="sd">           Args:</span>
<span class="sd">               span: the span class object</span>

<span class="sd">           Returns:</span>
<span class="sd">               the text between the two specified offsets</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_text_for_offsets</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end_offset</span><span class="p">)</span></div>

<div class="viewcode-block" id="TextCLAO.text_clao_element_dict"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.text_clao_element_dict">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">text_clao_element_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">TextCLAOElement</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Get dict of TextCLAOElement.element_name -&gt; TextCLAOElement. Used for recreating CLAOs from files.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_text_clao_element_dict</span><span class="p">:</span>
            <span class="bp">cls</span><span class="o">.</span><span class="n">_text_clao_element_dict</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">element_name</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">TextCLAOElement</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()}</span>
            <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_text_clao_element_dict</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
                <span class="bp">cls</span><span class="o">.</span><span class="n">_text_clao_element_dict</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">TextCLAO</span><span class="o">.</span><span class="n">_get_subclass_element_dict</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_text_clao_element_dict</span></div>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_get_subclass_element_dict</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">subclass</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Type</span><span class="p">[</span><span class="n">TextCLAOElement</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Helper method of cls.text_clao_element_dict to make recursive calls into subclasses.&quot;&quot;&quot;</span>
        <span class="n">classes</span> <span class="o">=</span> <span class="p">{</span><span class="n">c</span><span class="o">.</span><span class="n">element_name</span><span class="p">:</span> <span class="n">c</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">subclass</span><span class="o">.</span><span class="n">__subclasses__</span><span class="p">()}</span>
        <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">classes</span><span class="o">.</span><span class="n">values</span><span class="p">()):</span>
            <span class="n">classes</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">_get_subclass_element_dict</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">classes</span>

<div class="viewcode-block" id="TextCLAO.get_base_name_from_path"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAO.get_base_name_from_path">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_base_name_from_path</span><span class="p">(</span><span class="n">file_path</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get the base name in a specified path.</span>

<span class="sd">        Args:</span>
<span class="sd">            file_path: a specified path</span>

<span class="sd">        Returns:</span>
<span class="sd">            a base name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">file_path</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span></div></div>


<div class="viewcode-block" id="IdSpan"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.IdSpan">[docs]</a><span class="k">class</span> <span class="nc">IdSpan</span><span class="p">(</span><span class="n">IdCLAOElement</span><span class="p">,</span> <span class="n">Span</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;A basic Span with an id&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="s1">&#39;id_span&#39;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">element_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an IdSpan.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">element_id</span><span class="o">=</span><span class="n">element_id</span><span class="p">,</span> <span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="o">=</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="n">span_map</span><span class="p">,</span>
                         <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="IdSpan.from_span"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.IdSpan.from_span">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_span</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span> <span class="n">elemend_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;IdSpan&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Given a Span and an id, create an IdSpan&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">IdSpan</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">elemend_id</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">map</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">element_id</span></div>


<div class="viewcode-block" id="Embedding"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Embedding">[docs]</a><span class="k">class</span> <span class="nc">Embedding</span><span class="p">(</span><span class="n">IdCLAOElement</span><span class="p">,</span> <span class="n">TextCLAOElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing an embedding vector&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">EMBEDDING</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">vector</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an Embedding.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Embedding</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">element_id</span><span class="o">=</span><span class="n">element_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vector</span> <span class="o">=</span> <span class="n">vector</span>

<div class="viewcode-block" id="Embedding.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Embedding.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Embedding attributes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Embedding</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">VECTOR</span><span class="p">:</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">)}</span></div>

<div class="viewcode-block" id="Embedding.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Embedding.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Embedding attributes to XML.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">vector</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">VECTOR</span><span class="p">)</span>
        <span class="n">embedding</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Embedding</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">embedding</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">embedding</span></div>

<div class="viewcode-block" id="Embedding.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Embedding.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">ClinicalLanguageAnnotationObject</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Embedding element from CLAO.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="p">[</span><span class="s1">&#39;id&#39;</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">text</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;, &#39;</span><span class="p">))</span></div>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">Embedding</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">()</span> <span class="ow">and</span> <span class="nb">all</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Embedding(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vector</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span></div>


<div class="viewcode-block" id="TextCLAOElementContainer"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TextCLAOElementContainer">[docs]</a><span class="k">class</span> <span class="nc">TextCLAOElementContainer</span><span class="p">(</span><span class="n">CLAOElementContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Base class to create mix-ins that give container functionality to TextCLAOElements. i.e. Paragprahs contain</span>
<span class="sd">    Sentences, and Sentences contain Tokens&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TextCLAOElementContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">_from_xml_process_children</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]:</span>
        <span class="sd">&quot;&quot;&quot;Process any child elements of XML tree, and return element id ranges for each child type.</span>

<span class="sd">        Args:</span>
<span class="sd">            any child elements of XML tree</span>

<span class="sd">        Returns:</span>
<span class="sd">            element id ranges for each child type</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">children_ranges</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">child_elem</span> <span class="ow">in</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">getchildren</span><span class="p">():</span>
            <span class="n">tag</span> <span class="o">=</span> <span class="n">child_elem</span><span class="o">.</span><span class="n">tag</span>
            <span class="n">element_cls</span> <span class="o">=</span> <span class="n">clao</span><span class="o">.</span><span class="n">text_clao_element_dict</span><span class="p">()[</span><span class="n">tag</span><span class="p">]</span>
            <span class="n">element</span> <span class="o">=</span> <span class="n">element_cls</span><span class="o">.</span><span class="n">from_xml</span><span class="p">(</span><span class="n">child_elem</span><span class="p">,</span> <span class="n">clao</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">tag</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">children_ranges</span><span class="p">:</span>
                <span class="n">children_ranges</span><span class="p">[</span><span class="n">tag</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">element</span><span class="o">.</span><span class="n">element_id</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
            <span class="n">children_ranges</span><span class="p">[</span><span class="n">tag</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">element</span><span class="o">.</span><span class="n">element_id</span> <span class="o">+</span> <span class="mi">1</span>
            <span class="n">clao</span><span class="o">.</span><span class="n">insert_annotation</span><span class="p">(</span><span class="n">tag</span><span class="p">,</span> <span class="n">element</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">children_ranges</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span></div>


<div class="viewcode-block" id="EmbeddingContainer"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.EmbeddingContainer">[docs]</a><span class="k">class</span> <span class="nc">EmbeddingContainer</span><span class="p">(</span><span class="n">TextCLAOElementContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add class to any CLAOElement class to create a container for an embedding.</span>

<span class="sd">    Args:</span>
<span class="sd">        embedding_id (int): embedding id</span>
<span class="sd">        clao: the CLAO information to process</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">embedding_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an EmbeddingContainer.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span> <span class="o">=</span> <span class="n">embedding_id</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EmbeddingContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">embedding</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Embedding</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of Embedding element class, or single CLAOElement of Embedding element class.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Embedding</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span></div>


<div class="viewcode-block" id="Token"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Token">[docs]</a><span class="k">class</span> <span class="nc">Token</span><span class="p">(</span><span class="n">IdSpan</span><span class="p">,</span> <span class="n">EmbeddingContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing a token.</span>

<span class="sd">    Properties:</span>
<span class="sd">        embedding: Optional word embedding for this token</span>

<span class="sd">    Args:</span>
<span class="sd">        start_offset (int):  start offset for a Token</span>
<span class="sd">        end_offset (int): ending offset for a Token</span>
<span class="sd">        element_id (int): element id for Token</span>
<span class="sd">        clao (TextCLAO): the CLAO information to process</span>
<span class="sd">        text (str): the text for the Token</span>
<span class="sd">        embedding_id (int): embedding id. The default is None</span>
<span class="sd">        span_map: arbitrary dict of extra properties for this element. Default is None. The default is None</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">TOKEN</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">element_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">embedding_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Token.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Token</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="o">=</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">element_id</span><span class="o">=</span><span class="n">element_id</span><span class="p">,</span> <span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span>
                                    <span class="n">embedding_id</span><span class="o">=</span><span class="n">embedding_id</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="n">span_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>

<div class="viewcode-block" id="Token.from_id_span"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Token.from_id_span">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_id_span</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">IdSpan</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Token&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Given an IdSpan, create a Token.</span>

<span class="sd">        Args:</span>
<span class="sd">            span: IdSpan element class</span>
<span class="sd">            text (str): the text for the Token</span>
<span class="sd">            clao: the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            Token element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">Token</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">element_id</span><span class="p">,</span> <span class="n">clao</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">map</span><span class="p">)</span></div>

<div class="viewcode-block" id="Token.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Token.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Token attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with embedding id</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Token</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">TEXT</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">json_dict</span><span class="p">[</span><span class="n">EMBEDDING_ID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span>
        <span class="k">return</span> <span class="n">json_dict</span></div>

<div class="viewcode-block" id="Token.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Token.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Token attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a token with attributes in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">EMBEDDING_ID</span> <span class="ow">in</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="p">[</span><span class="n">EMBEDDING_ID</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">attribs</span><span class="p">[</span><span class="n">EMBEDDING_ID</span><span class="p">])</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="n">token</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Token</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">token</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">return</span> <span class="n">token</span></div>

<div class="viewcode-block" id="Token.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Token.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Token element from CLAO in a XML format.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Token element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
        <span class="n">end_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
        <span class="n">element_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">text</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">embedding_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;embedding_id&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">embedding_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">,</span> <span class="n">element_id</span><span class="p">,</span> <span class="n">clao</span><span class="p">,</span> <span class="n">text</span><span class="p">,</span> <span class="n">embedding_id</span><span class="p">,</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Token(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_embedding_id</span></div>


<div class="viewcode-block" id="TokenContainer"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.TokenContainer">[docs]</a><span class="k">class</span> <span class="nc">TokenContainer</span><span class="p">(</span><span class="n">TextCLAOElementContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create a TokenContainer.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">token_id_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_token_id_range</span> <span class="o">=</span> <span class="n">token_id_range</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">TokenContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of Token element class, or single CLAOElement of Token element class.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_id_range</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Token</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_id_range</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Heading"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Heading">[docs]</a><span class="k">class</span> <span class="nc">Heading</span><span class="p">(</span><span class="n">Span</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing a heading.&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">HEADING</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">text</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Heading.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_offset (int):  start offset for a Heading</span>
<span class="sd">            end_offset (int): ending offset for a Heading</span>
<span class="sd">            text:  the text for the Heading</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Heading</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>

<div class="viewcode-block" id="Heading.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Heading.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Heading attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a dictionary with Heading and Heading attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Heading</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">TEXT</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">}</span></div>

<div class="viewcode-block" id="Heading.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Heading.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Heading attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a heading with attributes in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="n">heading</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Heading</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">heading</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">return</span> <span class="n">heading</span></div>

<div class="viewcode-block" id="Heading.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Heading.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Heading element from CLAO in a XML format.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Heading element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
        <span class="n">end_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">text</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Heading(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">text</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">text</span></div>


<div class="viewcode-block" id="Entity"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Entity">[docs]</a><span class="k">class</span> <span class="nc">Entity</span><span class="p">(</span><span class="n">IdSpan</span><span class="p">,</span> <span class="n">TokenContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing an entity.</span>

<span class="sd">    Properties:</span>
<span class="sd">        tokens: List of tokens that make up the entity</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">ENTITY</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">entity_type</span><span class="p">:</span> <span class="n">EntityType</span><span class="p">,</span> <span class="n">confidence</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">literal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
                 <span class="n">token_id_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">span_map</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an Entity CLAOElement.</span>

<span class="sd">        Args:</span>
<span class="sd">            element_id: unique id for this element</span>
<span class="sd">            entity_type: Type of entity represented (e.g NER or FACT)</span>
<span class="sd">            confidence: percentage of confidence in accuracy of entity</span>
<span class="sd">            literal: name of the concept represented by this entity</span>
<span class="sd">            label: type of concept represented by this entity</span>
<span class="sd">            token_id_range: range [x,y) of token ids contained within this entity, where x is inclusive and y exclusive</span>
<span class="sd">            clao: TextCLAO this Entity is contained within</span>
<span class="sd">            start_offset: beginning index of this element in text (only needs to be included if Tokens in token_id_range</span>
<span class="sd">                          do not yet exist</span>
<span class="sd">            end_offset: ending index (non-inclusive) of this element in text (only needs to be included if Tokens in</span>
<span class="sd">                        token_id_range do not yet exist</span>
<span class="sd">            span_map: arbitrary dict of extra properties for this element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">confidence</span> <span class="o">=</span> <span class="n">confidence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">literal</span> <span class="o">=</span> <span class="n">literal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>

        <span class="n">start_offset</span> <span class="o">=</span> <span class="n">start_offset</span> <span class="k">if</span> <span class="n">start_offset</span> <span class="k">else</span> <span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Token</span><span class="p">,</span> <span class="n">token_id_range</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">.</span><span class="n">start_offset</span>
        <span class="n">end_offset</span> <span class="o">=</span> <span class="n">end_offset</span> <span class="k">if</span> <span class="n">end_offset</span> <span class="k">else</span> <span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Token</span><span class="p">,</span> <span class="n">token_id_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">end_offset</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Entity</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="o">=</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">element_id</span><span class="o">=</span><span class="n">element_id</span><span class="p">,</span> <span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span>
                                     <span class="n">token_id_range</span><span class="o">=</span><span class="n">token_id_range</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="n">span_map</span><span class="p">)</span>

<div class="viewcode-block" id="Entity.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Entity.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Entity attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a dictionary with Entity attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Entity</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span>
                <span class="s1">&#39;token_ids&#39;</span><span class="p">:</span> <span class="sa">f</span><span class="s2">&quot;[</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_token_id_range</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_token_id_range</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">,</span>
                <span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s1">&#39;confidence&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">confidence</span><span class="p">),</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">),</span>
                <span class="n">LITERAL</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">literal</span><span class="p">}</span></div>

<div class="viewcode-block" id="Entity.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Entity.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Entity attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a entity element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">literal</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">LITERAL</span><span class="p">)</span>
        <span class="n">entity</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Entity</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">entity</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">literal</span>
        <span class="k">return</span> <span class="n">entity</span></div>

<div class="viewcode-block" id="Entity.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Entity.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Entity element from CLAO in a XML format.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Entity element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
        <span class="n">end_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
        <span class="n">entity_type</span> <span class="o">=</span> <span class="n">EntityType</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;type&#39;</span><span class="p">))</span>
        <span class="n">confidence</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;confidence&#39;</span><span class="p">))</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">)</span>
        <span class="n">literal</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">text</span>
        <span class="n">token_id_range</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;token_ids&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;, &#39;</span><span class="p">)</span>
        <span class="n">token_id_range</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">token_id_range</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">element_id</span><span class="p">,</span> <span class="n">entity_type</span><span class="p">,</span> <span class="n">confidence</span><span class="p">,</span> <span class="n">literal</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">token_id_range</span><span class="p">,</span> <span class="n">clao</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">,</span>
                   <span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Entity(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, tokens: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">entity_type</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">confidence</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">confidence</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_id_range</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_token_id_range</span></div>


<div class="viewcode-block" id="EntityContainer"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.EntityContainer">[docs]</a><span class="k">class</span> <span class="nc">EntityContainer</span><span class="p">(</span><span class="n">TextCLAOElementContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Create an EntityContainer.&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">entity_id_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_entity_id_range</span> <span class="o">=</span> <span class="n">entity_id_range</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EntityContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">entities</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Entity</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of Entity element class, or single CLAOElement of Entity element class.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entity_id_range</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Entity</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entity_id_range</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="EntityGroup"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.EntityGroup">[docs]</a><span class="k">class</span> <span class="nc">EntityGroup</span><span class="p">(</span><span class="n">IdCLAOElement</span><span class="p">,</span> <span class="n">TextCLAOElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing an entity group.&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">ENTITY_GROUP</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">element_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">entity_type</span><span class="p">:</span> <span class="n">EntityType</span><span class="p">,</span> <span class="n">literal</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create an EntityGroup.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">EntityGroup</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">element_id</span><span class="o">=</span><span class="n">element_id</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">=</span> <span class="n">entity_type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">literal</span> <span class="o">=</span> <span class="n">literal</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">=</span> <span class="n">label</span>

<div class="viewcode-block" id="EntityGroup.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.EntityGroup.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Entity Group attributes.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">EntityGroup</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span>
                <span class="s1">&#39;entity_type&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span><span class="o">.</span><span class="n">name</span><span class="p">,</span>
                <span class="s1">&#39;literal&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">literal</span><span class="p">,</span>
                <span class="s1">&#39;label&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span>
                <span class="p">}</span></div>

<div class="viewcode-block" id="EntityGroup.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.EntityGroup.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Entity Group attributes to XML.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">literal</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">LITERAL</span><span class="p">)</span>
        <span class="n">entity_group</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">EntityGroup</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">entity_group</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">literal</span>
        <span class="k">return</span> <span class="n">entity_group</span></div>

<div class="viewcode-block" id="EntityGroup.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.EntityGroup.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get EntityGroup element from CLAO in a XML format.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Entity element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">element_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
        <span class="n">entity_type</span> <span class="o">=</span> <span class="n">EntityType</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;entity_type&#39;</span><span class="p">))</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">EntityType</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;label&#39;</span><span class="p">))</span>
        <span class="n">literal</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">text</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">element_id</span><span class="p">,</span> <span class="n">entity_type</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">element_id</span><span class="p">,</span> <span class="n">entity_type</span><span class="p">,</span> <span class="n">literal</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;EntityGroup(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span><span class="o">.</span><span class="n">name</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">literal</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">entity_type</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">entity_type</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">literal</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">literal</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">label</span></div>


<div class="viewcode-block" id="Sentence"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence">[docs]</a><span class="k">class</span> <span class="nc">Sentence</span><span class="p">(</span><span class="n">IdSpan</span><span class="p">,</span> <span class="n">TokenContainer</span><span class="p">,</span> <span class="n">EntityContainer</span><span class="p">,</span> <span class="n">EmbeddingContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing a sentence.</span>

<span class="sd">    Properties:</span>
<span class="sd">        tokens: List of tokens contained in the sentence</span>
<span class="sd">        entities: List of entities contained in the sentence</span>
<span class="sd">        embedding: Optional embedding for this Sentence</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">SENTENCE</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">element_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span>
                 <span class="n">entity_id_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">token_id_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                 <span class="n">embedding_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Sentence.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_offset: beginning index of this element in text (only needs to be included if Tokens in token_id_range</span>
<span class="sd">                          do not yet exist</span>
<span class="sd">            end_offset: ending index (non-inclusive) of this element in text (only needs to be included if Tokens in</span>
<span class="sd">                        token_id_range do not yet exist</span>
<span class="sd">            element_id: unique id for this element</span>
<span class="sd">            clao: TextCLAO this Entity is contained within</span>
<span class="sd">            entity_id_range: range [x,y) of entity ids contained within this entity group, where x is inclusive and</span>
<span class="sd">                y exclusive</span>
<span class="sd">            entity_id_range: range [x,y) of token ids contained within this entity, where x is inclusive and</span>
<span class="sd">                y exclusive</span>
<span class="sd">            embedding_id: id for the embedding</span>
<span class="sd">            span_map: arbitrary dict of extra properties for this element</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sentence</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="o">=</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">element_id</span><span class="o">=</span><span class="n">element_id</span><span class="p">,</span>
                                       <span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="n">entity_id_range</span><span class="o">=</span><span class="n">entity_id_range</span><span class="p">,</span> <span class="n">token_id_range</span><span class="o">=</span><span class="n">token_id_range</span><span class="p">,</span>
                                       <span class="n">embedding_id</span><span class="o">=</span><span class="n">embedding_id</span><span class="p">,</span> <span class="n">span_map</span><span class="o">=</span><span class="n">span_map</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Sentence.all_subspans"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.all_subspans">[docs]</a>    <span class="k">def</span> <span class="nf">all_subspans</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get all Spans contained within this document in a single list.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a unified list with all the members of this object that are Spans</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">all_spans</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">Span</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">all_spans</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span>
        <span class="n">all_spans</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">all_spans</span></div>

<div class="viewcode-block" id="Sentence.adjust_offsets"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.adjust_offsets">[docs]</a>    <span class="k">def</span> <span class="nf">adjust_offsets</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">:</span> <span class="nb">int</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Adjust the start and end offsets of this Sentence (and any existing spans therein) by the provided delta.</span>

<span class="sd">        Args:</span>
<span class="sd">            delta: How much to shift the offsets. To reduce the offsets, this should be negative.</span>

<span class="sd">        Returns:</span>
<span class="sd">            None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">adjust_offsets</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">span</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">all_subspans</span><span class="p">():</span>
            <span class="n">span</span><span class="o">.</span><span class="n">adjust_offsets</span><span class="p">(</span><span class="n">delta</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sentence.from_id_span"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.from_id_span">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_id_span</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">IdSpan</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="n">entity_id_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
                     <span class="n">token_id_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">embedding_id</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s1">&#39;Sentence&#39;</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Given an IdSpan and lists of Tokens, Entities, etc create a new Sentence&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">span</span><span class="o">.</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">element_id</span><span class="p">,</span> <span class="n">clao</span><span class="p">,</span> <span class="n">entity_id_range</span><span class="p">,</span> <span class="n">token_id_range</span><span class="p">,</span>
                   <span class="n">embedding_id</span><span class="p">,</span> <span class="n">span</span><span class="o">.</span><span class="n">map</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sentence.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Sentence attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with Entities and Tokens attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Sentence</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span>
                     <span class="n">ENTITIES</span><span class="p">:</span> <span class="p">[</span><span class="n">e</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">],</span>
                     <span class="n">TOKENS</span><span class="p">:</span> <span class="p">[</span><span class="n">t</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">]}</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">json_dict</span><span class="p">[</span><span class="n">EMBEDDING_ID</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span>

        <span class="k">return</span> <span class="n">json_dict</span></div>

<div class="viewcode-block" id="Sentence.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Sentence attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Sentence element in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="k">if</span> <span class="n">EMBEDDING_ID</span> <span class="ow">in</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="p">[</span><span class="n">EMBEDDING_ID</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">attribs</span><span class="p">[</span><span class="n">EMBEDDING_ID</span><span class="p">])</span>
        <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ENTITIES</span><span class="p">)</span>
        <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">TOKENS</span><span class="p">)</span>
        <span class="n">sentence</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Sentence</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">entity</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">:</span>
            <span class="n">entity</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">sentence</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">token</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">:</span>
            <span class="n">token</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">sentence</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">sentence</span></div>

<div class="viewcode-block" id="Sentence.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Sentence element from CLAO in a XML format.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Sentence element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">children_ranges</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_from_xml_process_children</span><span class="p">(</span><span class="n">xml_element</span><span class="p">,</span> <span class="n">clao</span><span class="p">)</span>
        <span class="n">start_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
        <span class="n">end_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
        <span class="n">element_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;id&#39;</span><span class="p">))</span>
        <span class="n">entity_id_range</span> <span class="o">=</span> <span class="n">children_ranges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Entity</span><span class="o">.</span><span class="n">element_name</span><span class="p">)</span>
        <span class="n">token_id_range</span> <span class="o">=</span> <span class="n">children_ranges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Token</span><span class="o">.</span><span class="n">element_name</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">embedding_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;embedding_id&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">embedding_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">,</span> <span class="n">element_id</span><span class="p">,</span> <span class="n">clao</span><span class="p">,</span> <span class="n">entity_id_range</span><span class="p">,</span> <span class="n">token_id_range</span><span class="p">,</span> <span class="n">embedding_id</span><span class="p">,</span>
                   <span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="p">)</span></div>

<div class="viewcode-block" id="Sentence.get_tokens_for_span"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.get_tokens_for_span">[docs]</a>    <span class="k">def</span> <span class="nf">get_tokens_for_span</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span</span><span class="p">:</span> <span class="n">Span</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Token</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the Tokens in this sentence that are covered by a given Span.</span>

<span class="sd">        Args:</span>
<span class="sd">            span: the Span to retrieve Tokens for</span>
<span class="sd">            partial: if True, will return Tokens that are only partially covered by the Span.</span>
<span class="sd">                     Otherwise, a Token will only be included if it is fully covered by the Span.</span>
<span class="sd">        Returns:</span>
<span class="sd">            A list of Tokens covered by the Span</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span>
        <span class="k">elif</span> <span class="n">partial</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="k">if</span> <span class="n">t</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">span</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">t</span> <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">tokens</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">t</span><span class="p">)]</span></div>

<div class="viewcode-block" id="Sentence.get_entity_spans_for_span"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Sentence.get_entity_spans_for_span">[docs]</a>    <span class="k">def</span> <span class="nf">get_entity_spans_for_span</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">span</span><span class="p">,</span> <span class="n">partial</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Entity</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Get the Entities in this sentence that are covered by a given Span.</span>

<span class="sd">        Args:</span>
<span class="sd">            span: the Span to retrieve Entities for</span>
<span class="sd">            partial: if True, will return Entities that are only partially covered by the Span.</span>
<span class="sd">                     Otherwise, a Entity will only be included if it is fully covered by the Span.</span>
<span class="sd">        Returns:</span>
<span class="sd">            A list of Entities covered by the Span</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span>
        <span class="k">elif</span> <span class="n">partial</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">es</span> <span class="k">for</span> <span class="n">es</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span> <span class="k">if</span> <span class="n">es</span><span class="o">.</span><span class="n">overlaps</span><span class="p">(</span><span class="n">span</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[</span><span class="n">es</span> <span class="k">for</span> <span class="n">es</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">entities</span> <span class="k">if</span> <span class="n">span</span><span class="o">.</span><span class="n">contains</span><span class="p">(</span><span class="n">es</span><span class="p">)]</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Sentence(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span><span class="si">}</span><span class="s1">, tokens: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tokens</span><span class="p">)</span><span class="si">}</span><span class="s1">, &#39;</span> \
               <span class="sa">f</span><span class="s1">&#39;entities: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">entities</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_token_id_range</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_token_id_range</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_entity_id_range</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_entity_id_range</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_embedding_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_embedding_id</span></div>


<div class="viewcode-block" id="SentenceContainer"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.SentenceContainer">[docs]</a><span class="k">class</span> <span class="nc">SentenceContainer</span><span class="p">(</span><span class="n">TextCLAOElementContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add class to any CLAOElement class to create a container for sentences&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sentence_id_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a SentenceContainer.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_sentence_id_range</span> <span class="o">=</span> <span class="n">sentence_id_range</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">SentenceContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">sentences</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Sentence</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of Sentence element class, or single CLAOElement of Sentence element class.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sentence_id_range</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Sentence</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sentence_id_range</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Paragraph"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Paragraph">[docs]</a><span class="k">class</span> <span class="nc">Paragraph</span><span class="p">(</span><span class="n">TextCLAOElement</span><span class="p">,</span> <span class="n">SentenceContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing a paragraph</span>

<span class="sd">    Properties:</span>
<span class="sd">        sentences: List of sentences contained in the paragraph</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">PARAGRAPH</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="n">sentence_id_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Paragraph.</span>

<span class="sd">        Args:</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>
<span class="sd">            sentence_id_range (Tuple[int, int]): sentence id range. Optional, the default is None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Paragraph</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="n">sentence_id_range</span><span class="o">=</span><span class="n">sentence_id_range</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

<div class="viewcode-block" id="Paragraph.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Paragraph.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Paragraph attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with Paragraph attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Paragraph</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">SENTENCES</span><span class="p">:</span> <span class="p">[</span><span class="n">s</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sentences</span><span class="p">]}</span></div>

<div class="viewcode-block" id="Paragraph.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Paragraph.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Paragraph attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Paragraph element in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">SENTENCES</span><span class="p">)</span>
        <span class="n">paragraph</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Paragraph</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">sentence</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">sentences</span><span class="p">:</span>
            <span class="n">sentence</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">paragraph</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">paragraph</span></div>

<div class="viewcode-block" id="Paragraph.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Paragraph.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Paragraph element from CLAO in a XML.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Paragraph element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">children_ranges</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_from_xml_process_children</span><span class="p">(</span><span class="n">xml_element</span><span class="p">,</span> <span class="n">clao</span><span class="p">)</span>
        <span class="n">sentence_id_range</span> <span class="o">=</span> <span class="n">children_ranges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Sentence</span><span class="o">.</span><span class="n">element_name</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">clao</span><span class="p">,</span> <span class="n">sentence_id_range</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Paragraph(sentences: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sentences</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_sentence_id_range</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_sentence_id_range</span></div>


<div class="viewcode-block" id="ParagraphContainer"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.ParagraphContainer">[docs]</a><span class="k">class</span> <span class="nc">ParagraphContainer</span><span class="p">(</span><span class="n">TextCLAOElementContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Add class to any CLAOElement class to create a container for paragraphs&quot;&quot;&quot;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">paragraph_id_range</span><span class="p">:</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">],</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a ParagraphContainer.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_paragraph_id_range</span> <span class="o">=</span> <span class="n">paragraph_id_range</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ParagraphContainer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">paragraphs</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">Paragraph</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of Paragraph element class, or single CLAOElement of Paragraph element class.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paragraph_id_range</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Paragraph</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paragraph_id_range</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">[]</span></div>


<div class="viewcode-block" id="Section"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Section">[docs]</a><span class="k">class</span> <span class="nc">Section</span><span class="p">(</span><span class="n">Span</span><span class="p">,</span> <span class="n">ParagraphContainer</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing a section</span>

<span class="sd">    Properties:</span>
<span class="sd">        paragraphs: List of paragraphs contained in the section</span>
<span class="sd">        heading: Optional heading object for the section</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">SECTION</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">,</span>
                 <span class="n">paragraph_id_range</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Tuple</span><span class="p">[</span><span class="nb">int</span><span class="p">,</span> <span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">heading_id</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Section.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Section</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">start_offset</span><span class="o">=</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="o">=</span><span class="n">end_offset</span><span class="p">,</span> <span class="n">clao</span><span class="o">=</span><span class="n">clao</span><span class="p">,</span>
                                      <span class="n">paragraph_id_range</span><span class="o">=</span><span class="n">paragraph_id_range</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_heading_id</span> <span class="o">=</span> <span class="n">heading_id</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">heading</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Optional</span><span class="p">[</span><span class="n">Heading</span><span class="p">]:</span>
        <span class="sd">&quot;&quot;&quot;Return a list of Heading element class, or single CLAOElement of Heading element class.&quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_heading_id</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">clao</span><span class="o">.</span><span class="n">get_annotations</span><span class="p">(</span><span class="n">Heading</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">_heading_id</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

<div class="viewcode-block" id="Section.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Section.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Section attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with Section attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_dict</span> <span class="o">=</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Section</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">PARAGRAPHS</span><span class="p">:</span> <span class="p">[</span><span class="n">p</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span> <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">]}</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">heading</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">json_dict</span><span class="p">[</span><span class="n">HEADING</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">heading</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">json_dict</span></div>

<div class="viewcode-block" id="Section.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Section.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Section attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Section element in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">PARAGRAPHS</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">HEADING</span> <span class="ow">in</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">HEADING</span><span class="p">)</span>
        <span class="n">section</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Section</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">heading</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">heading</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">paragraph</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">:</span>
            <span class="n">paragraph</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="n">section</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">section</span></div>

<div class="viewcode-block" id="Section.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Section.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Section element from CLAO in a XML.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Section element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">children_ranges</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">_from_xml_process_children</span><span class="p">(</span><span class="n">xml_element</span><span class="p">,</span> <span class="n">clao</span><span class="p">)</span>

        <span class="n">start_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;start&#39;</span><span class="p">))</span>
        <span class="n">end_offset</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;end&#39;</span><span class="p">))</span>
        <span class="n">paragraph_id_range</span> <span class="o">=</span> <span class="n">children_ranges</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">Paragraph</span><span class="o">.</span><span class="n">element_name</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">heading_id</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;heading_id&#39;</span><span class="p">))</span>
        <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
            <span class="n">heading_id</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">start_offset</span><span class="p">,</span> <span class="n">end_offset</span><span class="p">,</span> <span class="n">clao</span><span class="p">,</span> <span class="n">paragraph_id_range</span><span class="p">,</span> <span class="n">heading_id</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;Section(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">start_offset</span><span class="si">}</span><span class="s1">, </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">end_offset</span><span class="si">}</span><span class="s1">, paragraphs: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">paragraphs</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_paragraph_id_range</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_paragraph_id_range</span> \
               <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_heading_id</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">_heading_id</span></div>


<div class="viewcode-block" id="Text"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Text">[docs]</a><span class="k">class</span> <span class="nc">Text</span><span class="p">(</span><span class="n">Span</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO object representing unannotated text.&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">TEXT_ELEMENT</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">rax_text</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">description</span><span class="p">:</span> <span class="nb">str</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Text.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">rax_text</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">raw_text</span> <span class="o">=</span> <span class="n">rax_text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">description</span> <span class="o">=</span> <span class="n">description</span>

<div class="viewcode-block" id="Text.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Text.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Text attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with Text attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">TEXT</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_text</span><span class="p">,</span> <span class="n">DESCRIPTION</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">description</span><span class="p">}</span></div>

<div class="viewcode-block" id="Text.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Text.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with Text attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Text element in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">text</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">TEXT</span><span class="p">)</span>
        <span class="n">raw_text</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Text</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">raw_text</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">return</span> <span class="n">raw_text</span></div>

<div class="viewcode-block" id="Text.from_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Text.from_xml">[docs]</a>    <span class="nd">@classmethod</span>
    <span class="k">def</span> <span class="nf">from_xml</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">xml_element</span><span class="p">:</span> <span class="n">etree</span><span class="o">.</span><span class="n">_Element</span><span class="p">,</span> <span class="n">clao</span><span class="p">:</span> <span class="n">TextCLAO</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Get Text element from CLAO in a XML.</span>

<span class="sd">        Args:</span>
<span class="sd">            xml_element (etree._Element): Element from etree</span>
<span class="sd">            clao (TextCLAO): the CLAO information to process</span>

<span class="sd">        Returns:</span>
<span class="sd">            a Text element class</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">description</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">attrib</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">DESCRIPTION</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="n">xml_element</span><span class="o">.</span><span class="n">text</span>
        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">text</span><span class="p">,</span> <span class="n">description</span><span class="p">)</span></div>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;RawText(</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">raw_text</span><span class="p">)</span><span class="si">}</span><span class="s1">)&#39;</span>

    <span class="k">def</span> <span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">raw_text</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">raw_text</span></div>


<div class="viewcode-block" id="ActualLabel"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.ActualLabel">[docs]</a><span class="k">class</span> <span class="nc">ActualLabel</span><span class="p">(</span><span class="n">TextCLAOElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing an actual label.&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">ACTUAL_LABEL</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">actual_label_value</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a ActualLabel.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ActualLabel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">actual_label_value</span> <span class="o">=</span> <span class="n">actual_label_value</span>

<div class="viewcode-block" id="ActualLabel.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.ActualLabel.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with actual label attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with actual label attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">ActualLabel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">ACTUAL_LABEL</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">actual_label_value</span><span class="p">}</span></div>

<div class="viewcode-block" id="ActualLabel.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.ActualLabel.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with actual label attributes to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            actual label element in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">actual_label_value</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">ACTUAL_LABEL</span><span class="p">)</span>
        <span class="n">actual_label</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ActualLabel</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">actual_label</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">actual_label_value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">actual_label</span></div></div>


<div class="viewcode-block" id="PredictProbabilities"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.PredictProbabilities">[docs]</a><span class="k">class</span> <span class="nc">PredictProbabilities</span><span class="p">(</span><span class="n">TextCLAOElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing predicted probabilities.&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">PROBABILITY</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">probability</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a PredictProbability.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PredictProbabilities</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">probability</span> <span class="o">=</span> <span class="n">probability</span>

<div class="viewcode-block" id="PredictProbabilities.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.PredictProbabilities.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with predicted probabilities attributes.</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with predicted probabilities attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">PredictProbabilities</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">PROBABILITY</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">probability</span><span class="p">}</span></div>

<div class="viewcode-block" id="PredictProbabilities.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.PredictProbabilities.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with predicted probabilities to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            predicted probabilities element in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">predicted_prob</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">PROBABILITY</span><span class="p">)</span>
        <span class="n">predicted_probs</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">PredictProbabilities</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">predicted_probs</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">predicted_prob</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">predicted_probs</span></div></div>


<div class="viewcode-block" id="Predictions"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Predictions">[docs]</a><span class="k">class</span> <span class="nc">Predictions</span><span class="p">(</span><span class="n">TextCLAOElement</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;CLAO element representing predictions.&quot;&quot;&quot;</span>
    <span class="n">element_name</span> <span class="o">=</span> <span class="n">PREDICTION</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">prediction</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Create a Prediction.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Predictions</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">prediction</span> <span class="o">=</span> <span class="n">prediction</span>

<div class="viewcode-block" id="Predictions.to_json"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Predictions.to_json">[docs]</a>    <span class="k">def</span> <span class="nf">to_json</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Dict</span><span class="p">:</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with predictions attributes</span>

<span class="sd">        Returns:</span>
<span class="sd">            a json dictionary with predictions attributes</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="o">**</span><span class="nb">super</span><span class="p">(</span><span class="n">Predictions</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_json</span><span class="p">(),</span> <span class="n">PREDICTION</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">prediction</span><span class="p">}</span></div>

<div class="viewcode-block" id="Predictions.to_xml"><a class="viewcode-back" href="../../../src.clao.text_clao.html#src.clao.text_clao.Predictions.to_xml">[docs]</a>    <span class="k">def</span> <span class="nf">to_xml</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">:</span> <span class="n">Optional</span><span class="p">[</span><span class="n">etree</span><span class="o">.</span><span class="n">Element</span><span class="p">],</span> <span class="n">attribs</span><span class="p">:</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Add CLAO element with predictions to XML.</span>

<span class="sd">        Returns:</span>
<span class="sd">            predictions element in XML format</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">attribs</span><span class="p">:</span>
            <span class="n">attribs</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">attribs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">to_json</span><span class="p">()</span>

        <span class="n">prediction</span> <span class="o">=</span> <span class="n">attribs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">PREDICTION</span><span class="p">)</span>
        <span class="n">predictions</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">Predictions</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">to_xml</span><span class="p">(</span><span class="n">parent</span><span class="p">,</span> <span class="n">attribs</span><span class="p">)</span>
        <span class="n">predictions</span><span class="o">.</span><span class="n">text</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">prediction</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">predictions</span></div></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2022, Author

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>